REM Base64 has to be broken up into chunks, otherwise Flipper crashes

REM Encode file to base64. On Linux: 
REM cat file.txt | base64 -w 0 > encoded.txt 
REM and then to prepend STRING to each line
REM awk '{print "prefix" $0}' encoded.txt > encoded_string.txt
REM then copy and paste, then remove the first STRING and replace with $b64="

REM May need to uncomment and adjust per-line delay. Otherwise it may stumble over itself
REM particularly if the base64 is very large
REM DEFAULTDELAY 100

REM slow down flipper string entry so keyboard buffer doesn't get broken
REM not sure if needed or not
STRING_DELAY 100

DELAY 1000
GUI r
DELAY 500
STRING powershell
DELAY 500
ENTER
DELAY 750

REM Base64 goes here. Make sure to start with $b64="    and end with   ";
STRING $b64="/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBwgHBgkIBwgKCgkLDRYPDQwMDRsUFRAWIB0iIiAd
STRING Hx8kKDQsJCYxJx8fLT0tMTU3Ojo6Iys/RD84QzQ5OjcBCgoKDQwNGg8PGjclHyU3Nzc3Nzc3Nzc3
STRING Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3Nzc3N//AABEIAJQApgMBEQACEQED
STRING EQH/xAAbAAEAAgMBAQAAAAAAAAAAAAAABAUBAgMGB//EADwQAAEDAgQEAwUFBgcBAAAAAAEAAgME
STRING EQUSITFBUWFxEyKBBhQyQpEjUqGx4TNDcsHR8CQ0U2KCkvEV/8QAGgEBAAIDAQAAAAAAAAAAAAAA
STRING AAEEAgMFBv/EAC8RAQABAwIDBQcFAQAAAAAAAAABAgMRBCESMWETQVFx8AUiIzKBkaFCscHh8RT/
STRING 2gAMAwEAAhEDEQA/APuKAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC
STRING AgICDUuaOKDUyDgoyNDKRyUA2pjJsXDuNlOR2DgQCNQVIygICAgICAgICAgICAg1c4N3NkHMzfdF
STRING 1GRo6Qnc2QcnTAdVCXMzE7eXugq8dximwXDZa+uk+zYLAA+Z7uDWjiSkj5u92K4rP79ieMVdHVy+
STRING eCmppS1tO35QRxPfdc67rqoq+HTmI73Utez6Zo+JViZ7lvh3tfj+BBrcYg/+nSDeqpWgSAc3M2PW
STRING 1lvtay3c25T1V72hu2t+cdHusA9q8Kx2HPQ1ccjgPNHez2d27hW8qeF41wcLtII6KUMoCAgICAgI
STRING CAgIBQVtc8+ORyCgcBI4bFQluXFwuSgwg5VM8VNBJPUSCOKJpe97tmgcUkfM6mul9p8Tbi1RHIMN
STRING pyRQUzhq88ZXDnyvsFztZqMfDonzdTQaXPxa4z4ebFbSGR7pckzS45nEEOtw2vy5H+d6VFfDHDn1
STRING 68XRromZ4o9eujEVZU0w+3+1j/1G8O/6/VTNqmv5eaIu1UfNy8fXrq1mw/D8RmbUwl9NWs1ZNA7I
STRING 8H03U2796ztnMMLmmsX98YlZ0HtP7R4D5a+M4vRtOksFmzNHUbO/vVdCzrbdzadpcy9oLtveN4/L
STRING 2/s97X4TjrB7lUtMgF3ROGV7e7TqruVHD0DHteMzXAg8lKGyAgICAgICAgIKyu/zDvRYiOiW42CA
STRING UHz72vrJsexmXBG5o8MoXNNW7YzyEBzWfwgEFVNVqOxp935p5Luj0vbVZq+WHGqMjI446Zlm3yks
STRING HwDouPbimZzU7tyaoiIpU9IcYjqz73F4bHNGVzHZhe/fUW4nkFarixNHubypW51EXMXIxCdKBHd8
STRING b5PEbeztT9dLHn6rVHvc8LExjeObpJR09QM0LvBkBzDLt/1/sqO0rpnfeE9lRVy2ljJVUxLoXeKw
STRING bsbw9Dv6H0UzNuvnsj4lHKco1TTYbibo5J2+71Q1jnjdkffoVnRXes7U7x4NVy1YvfPtPjCyocf9
STRING psBcPFtjFFvmHlqGjvs71V+1rrde1W0ude9n3KN6d4/L2/s17aYX7QNc2llImjH2sEjckjO7TuOo
STRING V2JUJh6RkjXi7CCOilDZAQEBAQEGDsgrqwf4k9gVA45VCWL2QLoIVdhVLWPMr2lkpFvEZoTyvzWi
STRING 9Youx7yxY1NyzOaVBXYPUUt3NHiRD52DbuFy72iro3p3h17HtC3c2q2lT1Mc2UupZY2Pv+8bmafx
STRING BH1VemYziqJ9fdarirGaJj67x/CrxJ+KROY4VBjp7We6KmzOaedrm4/HorVqLE7Y36yq3pvxOeLb
STRING pDvSU/gRiqlxKoqhu3xXNa0Hta4358VruVcU8MURHl/rZbo4Y4prmrz/AMSqOSGQl7Ha8WEC439D
STRING x26rXcpqiN4bbdUTO0uVdhcVTmcwmJ7hY20B+mx6/msrd+aNp5MLunivMxzRqGGuoneG58jrkZNi
STRING 23G5H6LZcqt3Pea7dNy3PDz8P9ek9n8JZVY3FjBjye6texkjRbxXOBa7uB+fZW9BRVFEzM7Soe0q
STRING 6JriIjd67xmxG/ihpHG+qv5w5sUzKTBikZsHvYeoKmKolPDMJ8crJRdjgVkxdEBAQEBBVYqTHVxP
STRING Gxbb6f8AqiRyEgcOShLKDCDFzdBsHcja6CBX4RS1gOaPw5CPjaLX7jitFzT27nON1i1qrlraJzDz
STRING lZgElEzyMPhN+anLm27tBXPu6W7TOad4dSxrLNcYmOGUNrA1gDBZu3NUZme90IxjZyfTtMhlYcsv
STRING BxJcB07bbWWcV7YnkwmiM5jm5g1UTznPixi1zlGY3vew5DRTiiroj36eqfT0stdUCkp3FhcLyyN/
STRING ds4nueH6LPTWJu178mvVajsaOq3rsSjooxR0DWtZG3K3Ls0K9qdVFmOCjm52l0c3546+Sklnml1k
STRING lcel9PouTXduV/NLsUWrdHyw5h7mkZXkHvZYxVVE5iWU0xVGJhZ4bjFRSSAPeS2+vRXdPrq6ZxXv
STRING ChqNBRXGaNpeyosTE0QebOaRuNwu1TVFUZhwqqZpnErGN7Xjym6zYt0BAQV+LxF0ccg+Q6+qiRAG
STRING v6KEtwSOyDYG6CLV+8yO8GnPhNIu6c626Ac+q03Yu1e7RtHj/Tda7KmOOvfohw09XTBwa8BrBc53
STRING 5o3ddfM0/ULRRbu2+U8vHl+d4/MLFdyzdxmOfhGJ/G0/iU6lqRPHnaHZb2BI0d1HMKzbuRcjMevL
STRING oq3bc26uGfXn1d7g67FZtSFWYXS1V3FvhyH52CxPfmtN3TW7vON1qzq7tnlOyhrcKqaW7reLEPnj
STRING F7dwuXe0ddveN4dezrrdzadpQNRYRsMkjjZjGjVxVemia6uGFqu5TRTxTyelo6MYVhcxfZ8xaXzP
STRING HzOtw6C2i7tq1FqjEPO3bs3rmZeWZmewOebucLuPM8V52uZqqmqXpaYimmKYaSyZZmRA2LgXE24C
STRING 231TluygnkayN0lnZWi7gTe44pE5nCN4blttFile+y87s00B2AuF2vZ1czbxPc4ftOiIriqO966j
STRING d9kNdQbXXQcxNBuLrJDKAgwQHCxFwghT0DTrCcp+6dlGBCfG+N2WRpB/NQARLKDjV0sdXCYpb5b3
STRING 0NtVru2qbtPDU2WrtVqripRz73BG65ZUHaMgZD/y4fT6LD4tFM/q9d/r6M/g3Kox7vj3/ZBFZVRg
STRING vuchcS6aVhDL/dFtWjqVV7a7Rv3eMxOPLpHWYW+ws1bd/dETGfPrPSEyjxOKoLhfK9mjrkEE9HDQ
STRING qza1NFzMd8eufJWu6Wu3ifH1yndOuDoFYVWrYo2vziNodzA1UcMMpqqmMTKNTU1Q2nmirao1OeRx
STRING YTGG5WHZum9ue6TBnE5eSZC6mkdSy/tIdLcS3gfp/Neev2ZtVzEvS2b0XaIqhiopWTZbuLHt+Fw3
STRING HNa8NsVYcvcXEtM8xe1puGBoaD3UYZcbo9pGw07/AKLGSJXXszARH70bhsrrM6tAtf6rtaG3NFrM
STRING 97h+0bsV3OGO793qaI6OCvw5ywjN2BZIboCAgIMPaHtyuFweCCFLQjeEgf7SowIrmujdleCCoSAI
STRING MFt90GjmFBWVGGmdxc+UeU/ZxlgLGjkW8e6qXNLNc71eW20fRct6uLfKnznO8/VD8ebDnlr3sLbW
STRING EIcXBnUuPwjotHHXp5xM7eG+I657ob+zo1EZiJz47ZnpiOcrGDEGOe2OUGKVw8rXkebsdirlF+Jn
STRING FW0+uUqdzT1UxmneP2845pgcDx1W5oQsTwyGua1ziY5m/BKz4m/1HRartmm7GKm6xqKrM5pUcuH4
STRING lTOIMEVQOD43BpPcH+q5leiuR8u/4dWjXWquezn4GISeVmHSBx4vkYAPxWH/AB3p7mydXYj9X4kN
STRING CyBwfi8rXDf3aDUH+Im1x9PVZ9jb0+Krs5nwhh/0XL+abMY6yvaXEaeqaBFdjmlpDXC2nRXrOqt3
STRING dqXOvaS5a3q3XFIbSEdFaVFjAfKVMIdVIICAgICDV7GvbZwuEEOWjN80R9CoEcgtNnjKeqhJZBq+
STRING MO33QQqmgY95lbmZLb9ow2PrzHQrVXYpqnMbT4x63+rdRfrpjhnePCfW30Qn0dQyLwKZ8MQNy+UM
STRING sS7oOHdaZs3IjgoxHjP9fy3RftzVx1xM+EZ/nv8AJGhNZDOaeCMvLLF7ZZLtAPFrjr6arTbm9RVw
STRING U7455nb78/3bq6bFdHaVTjPKYjf7clw15G49F0Yc3budA8EWumALbajTsokebx2CeKrNR4cj4JGA
STRING F0bblhHTkVzdbYrqqiqmMutodRRTTwTOJRsOilq6mL3eKRsQN3yvYWADoDqStWmsV8cVYxEN2rv2
STRING 4tzGd5exjflkuuw4ayo3Zmk8FMISVIICAgICAgINJI2PFnAIIstK5usZuOSjA4G4NiCCoSwUHHyS
STRING 3blcx++otcJgRn0hZU+OCb5Cw24i9/w1WHBHFxdMM+0ng4OuWFkwLaKRkPI6oOjXtdxsUGSgyzzG
STRING wB15ILTDyww3iIc29rjmphCUpBAQEBAQEBAQEGj42yCz2jugiSUz2ax+YclGBwLG6gtym1lCVS+l
STRING xGge59DP7xETc09Q4nf7r9S38R2QZp8RpKqQQSNdS1R2hmAaXfwnZ3ogkSROZuNOaDkUGEBpvINS
STRING g7Pc6zYoyWvk+YfK3iUF3RQtp6ZkbG5WtGg5LJDugICAgICAgICAgICDnLCyQeYa80EV9PIwXYcw
STRING UCBWUNNXRmOpia9vJwUJbUdN7rTiHxHPDfhzuLjblc7oElO12rdCgiyROYfMPog5xkeKOiCzw+Fs
STRING spkLTYbnn0UoWykEBAQEBAQEBAQEBAQEBBykgZJuLHmEEWSnfHqPMOixHHfTikpV7MWoKiV1PHUt
STRING bNcgRv8AKXHpff0WPFGcMuzqxnGyPTB8lcI4mEknU/dCnO7HGz1MEQhiDBw3PNZodEBAQEBAQEBA
STRING QEBAQEBAQEBBxlp2SakWdzCCtnwsGYSiGN0jdnDRYcLLinGEjDKA0xdJJ8btAOQWUQxWCkEBAQEB
STRING AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBB//Z";

STRING $desktop = [Environment]::GetFolderPath("Desktop");
STRING $filename = $desktop+"\file.jpg";

STRING $bytes = [Convert]::FromBase64String($b64);
STRING [IO.File]::WriteAllBytes($filename, $bytes);
STRING Invoke-Item $filename;

ENTER
